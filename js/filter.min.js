function cascade(){var i=$(".grid").masonry({itemSelector:".grid-item",columnWidth:".grid-sizer",percentPosition:!0,gutter:".gutter-sizer"});i.imagesLoaded(function(){i.masonry("layout"),$(".grid-item img").addClass("not-loaded"),$("img.grid-item").addClass("not-loaded"),$("#project .images img").addClass("not-loaded"),$("img.not-loaded").lazyload({threshold:200,load:function(){$(this).removeClass("not-loaded"),i.imagesLoaded(function(){i.masonry("layout")})}}),$("img.not-loaded").trigger("scroll")})}function filter(){var i=[];$(".filter-link.current").each(function(){var t=$(this).data("tag");i.push(t)}),$(".plink").each(function(){for(var t=$(this),a=!1,e=0;e<i.length;e++)if(t.find(".project").hasClass(i[e])){a=!0;break}a?t.show():t.hide()})}function initFilter(){$(".filter-link").click(function(){$(this).hasClass("all")?$(this).hasClass("current")||($(".filter-link").removeClass("current"),$(this).addClass("current"),$(".plink").show()):($(".filter-link.all").removeClass("current"),$(this).toggleClass("current"),$(".filter-link").hasClass("current")?filter():($(".filter-link.all").addClass("current"),$(".plink").show())),cascade()}),cascade()}