function layout(){var t=$(".grid").masonry({itemSelector:".grid-item",columnWidth:".grid-sizer",percentPosition:!0,gutter:".gutter-sizer"});t.imagesLoaded(function(){t.masonry("layout"),$(".grid-item img").addClass("not-loaded"),$("#project .images img").addClass("not-loaded"),$("img.grid-item").addClass("not-loaded"),$(".not-loaded").lazyload({threshold:500,load:function(){$(this).removeClass("not-loaded"),t.imagesLoaded(function(){t.masonry("layout")})}}),$("img.not-loaded").trigger("scroll")})}function filter(){var t=[];$(".filter-link.current").each(function(){var i=$(this).data("tag");t.push(i)}),$(".plink").each(function(){for(var i=$(this),l=!1,a=0;a<t.length;a++)if(i.find(".project").hasClass(t[a])){l=!0;break}l?i.show():i.hide()})}function initFilter(){$(".filter-link").click(function(){$(this).hasClass("all")?$(this).hasClass("current")||($(".filter-link").removeClass("current"),$(this).addClass("current"),$(".plink").show()):($(".filter-link.all").removeClass("current"),$(this).toggleClass("current"),$(".filter-link").hasClass("current")?filter():($(".filter-link.all").addClass("current"),$(".plink").show())),layout()}),layout()}